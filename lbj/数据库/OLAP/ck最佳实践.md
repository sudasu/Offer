# ck最佳实践

推荐：建新表，以应对修改操作，以保留原始数据。

## join过多导致内存不足

ck虽然于传统的工作在磁盘的列式数据库不同，能有效的利用ssd和内存，但本质大部分工作还是在磁盘上完成的。而join的结果是临时表，只能全部存在内存，join操作过多自然会导致内存爆掉。

## 批量数据更新操作

尽量做1000条以上的批量删除，插入，更新操作，因为ck底层会不断做异步的数据合并操作，会影响查询性能。

## 并发控制

ck不支持高并发，官方建议qps为100，可通过配置文件修改。ck与传统关系型数据库不同在于并行查询，且默认单查询cpu使用数为服务器核数的一半，可通过配置文件修改。

## 新增列并加索引

在不对已有数据对应新列赋值的情况下，影响不大，主键索引，跳数索引均能加上。但是如果想对已有数据操作，则不推荐，建议新建表然后数据慢慢迁移，最后exchange替换或者直接使用。